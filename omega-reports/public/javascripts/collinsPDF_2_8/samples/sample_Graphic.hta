<html>
<head>
<title>HTML to PDF Sample</title>

<script SRC="../collinsPDF.js" language="JavaScript" ></script>
<script SRC="../collinsHtml.js" language="JavaScript" ></script>
<script language=javascript>
//************************************************************************
//                          Sample_HTML.hta
//        Author: Clif Collins				Date: June 2010
//------------------------------------------------------------------------
//
// 		Copyright (c) 2011 Clifford L. Collins 
// 		All rights are reserved 
//
//************************************************************************
//===========================================================
//			pdfName
//===========================================================
function pdfName()
{
	var name,n;
	name = window.location.pathname;
	if (name.substr(0,1) == '/') name = name.substr(1);
	n = name.lastIndexOf('.');
	name = name.substr(0,n) + '.pdf';
	return name;
}
//===========================================================
//                    execute
//===========================================================
function execute()
{
	var data,html,pdf,text,margin,usemargin;

	div = document.getElementById('htmldata');
	data = div.innerText;

	html = new html$();
	html.parse(data);

	pdf = new pdf$('',onPageheader);
	pdf.encoded = true;
	pdf.title  = 'Graphic and HTML Parsing';
	pdf.author = 'Clif Collins';
	pdf.keywords = 'HTML, PDF, Graphics, Examples';
	pdf.subject = 'Web Based PDF Generation';

	pdf.setMargin(1,1,1,1);
	pdf.drawMargin = false;

	html.writeToPdf(pdf);

	filename = pdfName();
	pdf.writeToFile(filename);
	window.open(filename);
}
//==================================================================================
//			onPageheader
//==================================================================================
function onPageheader(page,total,pdf)
{
	var text;

	pdf.xpos = 3.0 * 72;
	pdf.xmin = 0;
	pdf.xmax = 8.5 * 72;	
	if (pdf.landscape) pdf.xmax = 11 * 72;
	if (pdf.landscape) pdf.xpos = 4.5 * 72;

	pdf.lineBreak();
	pdf.setFont('gray',8);
	
	text = 'created on ' + (new Date());
	pdf.placeText(0.5,0.18,text);

	text = 'Page ' + page + ' of ' + total;
	pdf.setFont('black',10);
	pdf.centerText(text);

	pdf.setFont('Green',12);
	pdf.lineBreak();

	text = 'Web Generated PDF example provided by Collins Software';
	pdf.centerText(text);

}
</script>
</head>
<body>

<table width=100% height=100%>
<tr><td>
<input type=button value="Create and Open PDF" onclick="execute()"><br>
</td></tr>
<tr height=100%><td>
<textarea id=htmldata style="width:100%;height:100%">
<pdf margins=2 pageLength=11 pageWidth=8.5 landscape=true watermark="Sample" drawMargin=true title="Hello World">
A Sample Graphic Object<br>
<graphic WIDTH=300 HEIGHT=300 BORDER=0 clip=true range="0,0,100,100">
Image 0,0,100,100,a_sleep.jpg,0,;
Text 20,75,0,Hello World,,12,,;
Textbox Blue,1,solid,0.97,82,52,40,20,40,120,rounded,left,middle,They should have been here 4 hours ago!,3,Black,;
</graphic>
</textarea>
</td></tr></table>
</body>
</html>