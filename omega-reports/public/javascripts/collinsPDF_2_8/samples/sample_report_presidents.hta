<html>
<head>
<title>HTML to PDF Sample</title>

<script SRC="../collinsPDF.js" language="JavaScript" ></script>
<script SRC="../collinsHtml.js" language="JavaScript" ></script>
<script language=javascript>
//************************************************************************
//                          Sample_HTML.hta
//        Author: Clif Collins				Date: Jan 2011
//------------------------------------------------------------------------
//
// 		Copyright (c) 2011 Clifford L. Collins 
// 		All rights are reserved 
//
//************************************************************************
//===========================================================
//			pdfName
//===========================================================
function pdfName()
{
	var name,n;
	name = window.location.pathname;
	if (name.substr(0,1) == '/') name = name.substr(1);
	n = name.lastIndexOf('.');
	name = name.substr(0,n) + '.pdf';
	return name;
}
//===========================================================
//                    execute
//===========================================================
function execute()
{
	var data,html,pdf,text,div;

	div = document.getElementById('htmldata');
	data = div.innerText;

	html = new html$();
	html.parse(data);

	pdf = new pdf$('');
	pdf.setMargin(0.5,0.5,0.5,0.5);

	html.writeToPdf(pdf);

	filename = pdfName();
	pdf.writeToFile(filename);
	window.open(filename);
}
</script>
</head>
<body>
<table width=100% height=100%>
<tr><td>
<input type=button value="Create and Open PDF" onclick="execute()"><br>
</td></tr>
<tr height=100%><td>

<textarea id=htmldata style="width:100%;height:100%">
<pdf margin=1>

<Report columns=2 border=0 columnOrder=true Table=presidentTable>

<reportgroup key="{century}" keeptogether>
	<header>{myfirst({century})} Century Presidents</header>
	<footer><br></footer>
</reportgroup>

<detail cellspacing=0 border=1 cellpadding=2 header="white,black">
	<Column width=40 align=right>{Position}</Column>
	<Column width=120><font color=blue>{First_Name}</font></Column>
	<Column width=*>{Last_Name}</Column>

	<HEADER align=right>Pos</HEADER>
	<HEADER align=center>First Name</HEADER>
	<HEADER align=center>Last Name</HEADER>
</detail>
</Report>

<SCRIPT LOAD>
function myfirst(value)
{
	var n,text,i;
	n = parseInt(value);
	if (isNaN(n)) return value;
	text = '' + n;
	i = text.substr(text.length-1);
	if (i == '1') return n + 'st';
	if (i == '2') return n + 'nd';
	if (i == '3') return n + 'th';
	return n + 'th';
}
</SCRIPT>

<reportTable id=presidentTable FirstRowNames=true>
"ID","Position","First_Name","Middle_Name","Last_Name","Century"
1,1,"George",,"Washington",18
2,2,"John",,"Adams",19
3,3,"Thomas",,"Jefferson",19
4,4,"James",,"Madison",19
5,5,"James",,"Monroe",19
6,6,"John","Quincy","Adams",19
7,7,"Andrew",,"Jackson",19
8,8,"Martin",,"Van Buren",19
9,9,"William","Henry","Harrison",19
10,10,"John",,"Tyler",19
11,11,"James","K.","Polk",19
12,12,"Zachary",,"Taylor",19
13,13,"Millard",,"Fillmore",19
14,14,"Franklin",,"Pierce",19
15,15,"James",,"Buchanan",19
16,16,"Abraham",,"Lincoln",19
17,17,"Andrew",,"Johnson",19
18,18,"Ulysses","S.","Grant",19
19,19,"Rutherford","B.","Hayes",19
20,20,"James",,"Garfield",19
21,21,"Chester","A.","Arthur",19
22,22,"Grover",,"Cleveland",19
23,23,"Benjamin",,"Harrison",19
24,24,"Grover",,"Cleveland",19
25,25,"William",,"McKinley",19
26,26,"Theodore",,"Roosevelt",20
27,27,"William","Howard","Taft",20
28,28,"Woodrow",,"Wilson",20
29,29,"Warren","G.","Harding",20
30,30,"Calvin",,"Coolidge",20
31,31,"Herbert",,"Hoover",20
32,32,"Franklin","D.","Roosevelt",20
33,33,"Harry","S.","Truman",20
34,34,"Dwight","D.","Eisenhower",20
35,35,"John","F.","Kennedy",20
36,36,"Lyndon","B.","Johnson",20
37,37,"Richard","M.","Nixon",20
38,38,"Gerald","R.","Ford",20
39,39,"James",,"Carter",20
40,40,"Ronald",,"Reagan",20
41,41,"George","H. W.","Bush",20
42,42,"William","J.","Clinton",20
43,43,"George","W.","Bush",21
44,44,"Barack",,"Obama",21
</reportTable>

</textarea>
</td></tr></table>

</body>
</html>