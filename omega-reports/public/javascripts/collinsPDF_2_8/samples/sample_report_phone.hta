<html>
<head>
<title>HTML to PDF Sample</title>

<script SRC="../collinsPDF.js" language="JavaScript" ></script>
<script SRC="../collinsHtml.js" language="JavaScript" ></script>
<script language=javascript>
//************************************************************************
//                          Sample_HTML.hta
//        Author: Clif Collins				Date: Jan 2011
//------------------------------------------------------------------------
//
// 		Copyright (c) 2011 Clifford L. Collins 
// 		All rights are reserved 
//
//************************************************************************
//===========================================================
//			pdfName
//===========================================================
function pdfName()
{
	var name,n;
	name = window.location.pathname;
	if (name.substr(0,1) == '/') name = name.substr(1);
	n = name.lastIndexOf('.');
	name = name.substr(0,n) + '.pdf';
	return name;
}
//===========================================================
//                    execute
//===========================================================
function execute()
{
	var data,html,pdf,text,div;

	div = document.getElementById('htmldata');
	data = div.innerText;

	html = new html$();
	html.parse(data);

	pdf = new pdf$('');
	pdf.setMargin(0.5,0.5,0.5,0.5);

	html.writeToPdf(pdf);

	filename = pdfName();
	pdf.writeToFile(filename);
	window.open(filename);
}
</script>
</head>
<body>

<table width=100% height=100%>
<tr><td>
<input type=button value="Create and Open PDF" onclick="execute()"><br>
</td></tr>
<tr height=100%><td>

<textarea id=htmldata style="width:100%;height:100%">
<center>Telephone Country Codes</center>
<Report columns=5 columnOrder=true style="font-size:8pt" TABLE=codeTable> 
	<detail nowrap border=1 cellspacing=0 header="white,black">
		<Column width=40 align=right>{Code}</Column>
		<Column width=*>{Country}</Column>
		<HEADER align=right>Code</HEADER>
		<HEADER align=center>Country</HEADER>
	</detail>
</Report>

<reportTable id=codeTable FirstRowNames=true>
"ID","Code","Country"
1,"+93","Afghanistan"
2,"+355","Albania"
3,"+213","Algeria"
4,"+684","American Samoa"
5,"+376","Andorra"
6,"+244","Angola"
7,"+1","Anguilla"
8,"+1","Antigua and Barbuda"
9,"+54","Argentine Republic"
10,"+374","Armenia"
11,"+297","Aruba"
12,"+247","Ascension"
13,"+61","Australia"
14,"+672","Australian External Territories"
15,"+43","Austria"
16,"+994","Azerbaijani Republic"
17,"+1","Bahamas"
18,"+973","Bahrain"
19,"+880","Bangladesh"
20,"+1","Barbados"
21,"+375","Belarus"
22,"+32","Belgium"
23,"+501","Belize"
24,"+229","Benin"
25,"+1","Bermuda"
26,"+975","Bhutan"
27,"+591","Bolivia"
28,"+387","Bosnia and Herzegovina"
29,"+267","Botswana"
30,"+55","Brazil"
31,"+1","British Virgin Islands"
32,"+673","Brunei Darussalam"
33,"+359","Bulgaria"
34,"+226","Burkina Faso"
35,"+257","Burundi"
36,"+855","Cambodia"
37,"+237","Cameroon"
38,"+1","Canada"
39,"+238","Cape Verde"
40,"+1","Cayman Islands"
41,"+236","Central African Republic"
42,"+235","Chad"
43,"+56","Chile"
44,"+86","China"
45,"+61","Christmas Island"
46,"+61","Cocos"
47,"+57","Colombia"
48,"+269","Comoros"
49,"+242","Congo-Brazzaville"
50,"+243","Congo-Kinshasa"
51,"+682","Cook Islands"
52,"+506","Costa Rica"
53,"+225","Côte d'Ivoire"
54,"+385","Croatia"
55,"+53","Cuba"
56,"+357","Cyprus"
57,"+420","Czech Republic"
58,"+45","Denmark"
59,"+246","Diego Garcia"
60,"+253","Djibouti"
61,"+1","Dominica"
62,"+1","Dominican Republic"
63,"+670","East Timor"
64,"+593","Ecuador"
65,"+20","Egypt"
66,"+503","El Salvador"
67,"+240","Equatorial Guinea"
68,"+291","Eritrea"
69,"+372","Estonia"
70,"+251","Ethiopia"
71,"+388","Europe"
72,"+500","Falkland Islands"
73,"+298","Faroe Islands"
74,"+679","Fiji"
75,"+358","Finland"
76,"+33","France"
77,"+594","French Guiana"
78,"+689","French Polynesia"
79,"+241","Gabonese Republic"
80,"+220","Gambia"
81,"+995","Georgia"
82,"+49","Germany"
83,"+233","Ghana"
84,"+350","Gibraltar"
85,"+881","Global Mobile Satellite System"
86,"+30","Greece"
87,"+299","Greenland"
88,"+1","Grenada and Carriacou"
89,"+590","Guadeloupe"
90,"+1","Guam"
91,"+502","Guatemala"
92,"+224","Guinea"
93,"+245","Guinea-Bissau Republic of"
94,"+592","Guyana"
95,"+509","Haiti"
96,"+504","Honduras"
97,"+852","Hong Kong"
98,"+36","Hungary"
99,"+354","Iceland"
100,"+91","India"
101,"+62","Indonesia"
102,"+871","Inmarsat Atlantic Ocean-East"
103,"+874","Inmarsat Atlantic Ocean-West"
104,"+873","Inmarsat Indian Ocean"
105,"+872","Inmarsat Pacific Ocean"
106,"+870","Inmarsat Single Number Access"
107,"+800","International Freephone Service"
108,"+882","International Networks"
109,"+979","International Premium Rate Service"
110,"+991","International Public Correspondence Service"
111,"+808","International Shared Cost Service"
112,"+98","Iran"
113,"+964","Iraq"
114,"+353","Ireland"
115,"+972","Israel"
116,"+39","Italy"
117,"+1","Jamaica"
118,"+81","Japan"
119,"+962","Jordan"
120,"+7","Kazakstan"
121,"+254","Kenya"
122,"+686","Kiribati"
123,"+850","Korea"
124,"+82","Korea"
125,"+965","Kuwait"
126,"+996","Kyrgyz Republic"
127,"+856","Lao People's Democratic Republic"
128,"+371","Latvia"
129,"+961","Lebanon"
130,"+266","Lesotho"
131,"+231","Liberia"
132,"+218","Libya"
133,"+423","Liechtenstein"
134,"+370","Lithuania"
135,"+352","Luxembourg"
136,"+853","Macao"
137,"+389","Macedonia"
138,"+261","Madagascar"
139,"+265","Malawi"
140,"+60","Malaysia"
141,"+960","Maldives"
142,"+223","Mali"
143,"+356","Malta"
144,"+692","Marshall Islands"
145,"+596","Martinique"
146,"+222","Mauritania"
147,"+230","Mauritius"
148,"+269","Mayotte"
149,"+52","Mexico"
150,"+691","Micronesia"
151,"+373","Moldova"
152,"+377","Monaco"
153,"+976","Mongolia"
154,"+1","Montserrat"
155,"+212","Morocco"
156,"+258","Mozambique"
157,"+95","Myanmar"
158,"+264","Namibia"
159,"+674","Nauru"
160,"+977","Nepal"
161,"+31","Netherlands"
162,"+599","Netherlands Antilles"
163,"+687","New Caledonia"
164,"+64","New Zealand"
165,"+505","Nicaragua"
166,"+227","Niger"
167,"+234","Nigeria"
168,"+683","Niue"
169,"+1","Northern Mariana Islands"
170,"+47","Norway"
171,"+968","Oman"
172,"+92","Pakistan"
173,"+680","Palau"
174,"+970","Palestine"
175,"+507","Panama"
176,"+675","Papua New Guinea"
177,"+595","Paraguay"
178,"+51","Peru"
179,"+63","Philippines"
180,"+48","Poland"
181,"+351","Portugal"
182,"+1","Puerto Rico"
183,"+974","Qatar"
184,"+262","Reunion"
185,"+40","Romania"
186,"+7","Russian Federation"
187,"+250","Rwandese Republic"
188,"+290","Saint Helena"
189,"+1","Saint Kitts and Nevis"
190,"+1","Saint Lucia"
191,"+508","Saint Pierre and Miquelon"
192,"+1","Saint Vincent and the Grenadines"
193,"+685","Samoa"
194,"+378","San Marino"
195,"+239","São Tome and Principe"
196,"+966","Saudi Arabia"
197,"+221","Senegal"
198,"+381","Serbia and Montenegro"
199,"+248","Seychelles"
200,"+232","Sierra Leone"
201,"+65","Singapore"
202,"+421","Slovak Republic"
203,"+386","Slovenia"
204,"+677","Solomon Islands"
205,"+252","Somali Democratic Republic"
206,"+27","South Africa"
207,"+34","Spain"
208,"+94","Sri Lanka"
209,"+249","Sudan"
210,"+597","Suriname"
211,"+268"," Swaziland Kingdom of"
212,"+46","Sweden"
213,"+41","Switzerland"
214,"+963","Syrian Arab Republic"
215,"+886","Taiwan"
216,"+992","Tajikistan"
217,"+255","Tanzania"
218,"+66","Thailand"
219,"+228","Togolese Republic"
220,"+690","Tokelau"
221,"+676","Tonga"
222,"+1","Trinidad and Tobago"
223,"+216","Tunisia"
224,"+90","Turkey"
225,"+993","Turkmenistan"
226,"+1","Turks and Caicos Islands"
227,"+688","Tuvalu"
228,"+256","Uganda"
229,"+380","Ukraine"
230,"+971","United Arab Emirates"
231,"+44","United Kingdom of Great Britain and Northern Ireland"
232,"+1","United States"
233,"+1","United States Virgin Islands"
234,"+878","Universal Personal Telecommunication Service"
235,"+598","Uruguay"
236,"+998","Uzbekistan"
237,"+678","Vanuatu"
238,"+39","Vatican City State"
239,"+58","Venezuela"
240,"+84","Viet Nam"
241,"+681","Wallis and Futuna"
242,"+967","Yemen"
243,"+260","Zambia"
244,"+263","Zimbabwe"
</reportTable>

</textarea>
</td></tr></table>


</body>
</html>