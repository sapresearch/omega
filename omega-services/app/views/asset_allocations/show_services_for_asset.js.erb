$("#working_list_title").html("<%= @asset.name %>");
$("#working_list_title").removeClass("service");
$("#working_list_title").addClass("asset");
$("#working_list_block").html("<%= escape_javascript(render "leaf_services_ul", :asset_id=>@asset.id) %>");

/* clear */
$(".connectedSortable").removeClass("connectedSortable")
$(".active").removeClass("active")
$(".assets_list .main_list_item").stop(true,true).stopTime().css("background-color","lightblue");
$(".leaf_services_list .main_list_item").stop(true,true).stopTime().css("background-color","green");
$(".main_list_item").removeClass("main_list_item")
$(".list_fieldset").droppable("destroy")
$(".assets_list").sortable("option","connectWith", false)
$(".assets_list li.ui-state-disabled").hide()
$(".assets_list li:not(.ui-state-disabled)").show()
$(".leaf_services_list li.ui-state-disabled").hide()
$(".leaf_services_list li:not(.ui-state-disabled)").show()
$(".exchange").css("visibility","hidden")

/* set new environment */
<% @leaf_services.each do |leaf_service| %>
  $("#leaf_services_list_block .leaf_service_<%= leaf_service.id.to_s %>:not(.ui-state-disabled)").hide()
  $("#leaf_services_list_block .leaf_service_<%= leaf_service.id.to_s %>.ui-state-disabled").show()
<% end %>
  
$(".leaf_services_list").addClass("connectedSortable");
$(".leaf_services_list").parents("fieldset").addClass("active");
$("#leaf_services_exchange").css("visibility","visible")
$(".assets_list .asset_<%= @asset.id.to_s %>").addClass("main_list_item")
$(".main_list_item").everyTime(10, function(){
  $(this).animate({backgroundColor:'lightyellow'}, 500).animate({backgroundColor:'lightblue'}, 500);
});

$("#leaf_services_list_fieldset").droppable({
  hoverClass: 'drop_leaf_service_hover',
  accept: '.connectedSortable li'
})

$("#working_list_fieldset").droppable({
  hoverClass: 'drop_leaf_service_hover',
  accept: '.connectedSortable li'
})
  
$(".tipsy").remove();
